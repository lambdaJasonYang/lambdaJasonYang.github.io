---
title: Lean Simple Prog Lang implementation
tags: mathcs, puremath ,categorytheory
toc: y
---

# Small Step



# Semantics

```hs
section basiclang

inductive Term : Type 
| T : Term 
| F : Term 
| O : Term 
| IfThenElse : Term -> Term -> Term -> Term 
| S : Term -> Term 
| P : Term -> Term 
| IsZero : Term -> Term

open Term

def eval : Term -> Term
| (IfThenElse T s2 s3) := s2 
| (IfThenElse F s2 s3) := s3
| (IfThenElse s1 s2 s3) := 
  let ns1 := eval s1 in (IfThenElse ns1 s1 s2) 
| (S s1) := 
  let ns1 := eval s1 in (S ns1)
| (P O) := O
| (P (S k)) := k 
| (P s1) := 
  let ns1 := eval s1 in (P ns1)
| (IsZero O) := T 
| (IsZero (S k)) := F 
| (IsZero s1) :=
  let ns1 := eval s1 in (IsZero ns1)
| _ := F

#reduce eval $ P $ S $ P O
#reduce eval $ IsZero O
#reduce eval $ IfThenElse (IsZero O) (S O) (S $ S O)
---  s1 -> ns1
--- ---------------
---  S s1 -> S ns1

def ToNat : Term -> nat 
| O := 0 
| (S (n: Term)) := 1 + ToNat n 
| _ := 1

#reduce ToNat (eval $ S $ S $ S $ O)
end basiclang

```