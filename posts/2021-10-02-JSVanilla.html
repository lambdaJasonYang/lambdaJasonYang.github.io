<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="Content-Type" content="text/html" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- <meta
            http-equiv="Content-Security-Policy"
            content="default-src *" /> -->

        <!-- Icon start -->
        <link rel="icon" href="../images/icons/IconSheet.svg#browserlogo">
        <link rel="apple-touch-icon" href="../images/icons/IconSheet.svg#browserlogo">
        <link rel="shortcut icon" href="../images/icons/IconSheet.svg#browserlogo" />
        <link rel="mask-icon" href="../images/icons/IconSheet.svg#browserlogo" />
        <!-- Icon end -->

        <!-- Global site tag (gtag.js) - Google Analytics START ------------------->

        <script defer src="https://www.googletagmanager.com/gtag/js?id=G-2W1VXE5GSE"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-2W1VXE5GSE');
        </script>
        
        <!-- Global site tag (gtag.js) - Google Analytics END ---------------------->

        <!-- NO JS Behavior START -->
        <noscript>
            <style>
                nav.sidenav {display:none;}
                li.nav-item{display:none;}
            </style>
        </noscript>
         <!-- NO JS Behavior END -->

        <title>Jason Yang - JS WebAPIs and Website CORS</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
    </head>

    <body>
        <!-- Side navigation start -->
        <nav class="sidenav">
            <li class="logo">
                <a href="#" class="nav-link">
                    <span class="link-text logo-text">Jason</span>
                    <svg><use href="../images/icons/IconSheet.svg#sidebardod"></use></svg>
                </a>
            </li>
        
            
            <li class="nav-item">
                <a href="../tags/mathcs.html" class="nav-link">
                    <svg><use href="../images/icons/IconSheet.svg#lambda"></use></svg>
                    <span class="link-text">Math/CS</span>
                </a>
            </li>
                
            <li class="nav-item">
                <a href="../tags/prog.html" class="nav-link">
                    <svg><use href="../images/icons/IconSheet.svg#progcode"></use></svg>
                    <span class="link-text">Prog</span>
                </a>
            </li>


            <li class="nav-item">
                <a href="../tags/AI.html" class="nav-link">
                    <svg><use href="../images/icons/IconSheet.svg#AIbrain"></use></svg>
                    <span class="link-text">ML/AI</span>
                </a>
            </li>

            <li class="nav-item">
                <a href="../tags/tech.html" class="nav-link">
                    <svg><use href="../images/icons/IconSheet.svg#hardware"></use></svg>
                    <span class="link-text">Tech</span>
                </a>
            </li>

            <li class="nav-item">
                <a href="../tags/musings.html" class="nav-link">
                    <svg><use href="../images/icons/IconSheet.svg#thinker"></use></svg>
                    <span class="link-text">Musings</span>
                </a>
            </li>


            <li class="nav-item">
                <a href="https://github.com/userJY" class="nav-link">
                    <svg><use href="../images/icons/IconSheet.svg#github"></use></svg>
                    <span class="link-text">Github</span>
                </a>
            </li>
        </nav>
        <!-- Side navigation end -->
        <div id="header">
            <div id="logo">
                <a href="../">Jason Yang</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>JS WebAPIs and Website CORS</h1>
            

            <div class="info">
    Posted on October  2, 2021
    
</div>
<div class="info">
    
    Tags: <a title="All pages tagged 'prog'." href="../tags/prog.html">prog</a>, <a title="All pages tagged 'cloud'." href="../tags/cloud.html">cloud</a>, <a title="All pages tagged 'frontend'." href="../tags/frontend.html">frontend</a>
    
</div>
<div id="TOC"><ul>
<li><a href="#content-security-policy"><span class="toc-section-number">1</span> Content security policy</a></li>
<li><a href="#apis"><span class="toc-section-number">2</span> API’s</a>
<ul>
<li><a href="#audio"><span class="toc-section-number">2.1</span> Audio</a></li>
<li><a href="#clipboard"><span class="toc-section-number">2.2</span> Clipboard</a></li>
<li><a href="#broadcast-channel"><span class="toc-section-number">2.3</span> Broadcast channel</a></li>
</ul></li>
<li><a href="#send-html-request-with-js"><span class="toc-section-number">3</span> Send HTML request with js</a></li>
<li><a href="#select-element-by-class-or-id"><span class="toc-section-number">4</span> Select element by class or id</a></li>
<li><a href="#more-complex-selector"><span class="toc-section-number">5</span> More Complex selector</a></li>
<li><a href="#building-html-element-through-vanilla-js"><span class="toc-section-number">6</span> Building HTML element through vanilla JS</a></li>
<li><a href="#promises-async-timeout"><span class="toc-section-number">7</span> Promises, Async, Timeout</a></li>
<li><a href="#location.hash"><span class="toc-section-number">8</span> location.hash</a></li>
<li><a href="#js-for-react"><span class="toc-section-number">9</span> JS for React</a></li>
<li><a href="#web-apis"><span class="toc-section-number">10</span> Web apis</a></li>
<li><a href="#this-and-bind"><span class="toc-section-number">11</span> this and bind</a>
<ul>
<li><a href="#arrow-vs-function"><span class="toc-section-number">11.1</span> Arrow vs function()</a></li>
</ul></li>
<li><a href="#prototype-give-pseudo-class-functionality-to-js-functions"><span class="toc-section-number">12</span> Prototype give pseudo-class functionality to JS functions</a></li>
</ul></div>
<section id="content-security-policy" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Content security policy</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;meta</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ot">            http-equiv=</span><span class="st">&quot;Content-Security-Policy&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ot">            content=</span><span class="st">&quot;default-src '*'; frame-ancestors http://trialservice.byethost14.com/iplog.php&quot;</span> <span class="kw">/&gt;</span></span></code></pre></div>
<p>This example explains how this works:</p>
<ul>
<li>Site A adds CORS headers to allow site B access to a resource on site A, such as a font.</li>
<li>Site B can then access that resource due to the CORS header.
Without the CORS header, Site B would not be able to access the resource on Site A. View the following pages for further details.</li>
</ul>
<p>The following requests use CORS.</p>
<ul>
<li>Invocations of the XMLHttpRequest or Fetch APIs.</li>
<li>Web Fonts (for cross-domain font usage in <span class="citation" data-cites="font-face">@font-face</span> within CSS).</li>
<li>WebGL textures.</li>
<li>Images/video frames drawn to a canvas using drawImage().</li>
<li>CSS Shapes from images.</li>
</ul>
<p>By default all servers are same-origin. If we made a button on client that sends a fetch request to some server.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Access</span> to fetch at <span class="st">'http://server.com/hi.php'</span> from origin <span class="st">'http://client.com:8000'</span> has been blocked by CORS policy: No <span class="st">'Access-Control-Allow-Origin'</span> header is present on the requested resource. If an opaque response serves your needs, set the request<span class="st">'s mode to '</span>no-cors<span class="st">' to fetch the resource with CORS disabled.</span></span></code></pre></div>
<p>Solution add <code>Access-Control-Allow-Origin: http://client.com:8000</code> to the server response header by modifying the server’s code.</p>
<p>WARN: DO NOT CONFUSE the “cors” “no-cors” parameter in a fetch function. It is effectively meaningless whether you set it or not. All it does is show you an error or not, it will not give the client access to the server resource !</p>
</section>
<section id="apis" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> API’s</h1>
<section id="audio" class="level2" data-number="2.1">
<h2 data-number="2.1"><span class="header-section-number">2.1</span> Audio</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> flag <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> audio <span class="op">=</span> <span class="kw">new</span> <span class="fu">Audio</span>(<span class="st">&quot;https://raw.githubusercontent.com/bleh/bleh.github.io/master/bleh.mp3&quot;</span>)<span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>      audio<span class="op">.</span><span class="at">loop</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;music&quot;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span>e<span class="kw">=&gt;</span>{</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        flag <span class="op">===</span> <span class="kw">false</span> <span class="op">?</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>            (audio<span class="op">.</span><span class="fu">play</span>()<span class="op">,</span> flag <span class="op">=</span> <span class="kw">true</span><span class="op">,</span> e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">innerText</span> <span class="op">=</span> <span class="st">&quot;playing&quot;</span>) <span class="op">:</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            (audio<span class="op">.</span><span class="fu">pause</span>()<span class="op">,</span> flag <span class="op">=</span> <span class="kw">false</span><span class="op">,</span> e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">innerText</span> <span class="op">=</span> <span class="st">&quot;paused&quot;</span>)<span class="op">;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span><span class="kw">false</span>)</span></code></pre></div>
</section>
<section id="clipboard" class="level2" data-number="2.2">
<h2 data-number="2.2"><span class="header-section-number">2.2</span> Clipboard</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> e<span class="kw">=&gt;</span>{</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">navigator</span><span class="op">.</span><span class="at">clipboard</span><span class="op">.</span><span class="fu">readText</span>()<span class="op">.</span><span class="fu">then</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>      clipText <span class="kw">=&gt;</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;sometextdiv&quot;</span>)<span class="op">.</span><span class="at">innerText</span> <span class="op">=</span> clipText)<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>      })</span></code></pre></div>
</section>
<section id="broadcast-channel" class="level2" data-number="2.3">
<h2 data-number="2.3"><span class="header-section-number">2.3</span> Broadcast channel</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> chan <span class="op">=</span> <span class="kw">new</span> <span class="fu">BroadcastChannel</span>(<span class="st">'test_channel'</span>)<span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>      chan<span class="op">.</span><span class="at">onmessage</span> <span class="op">=</span> <span class="kw">function</span> (<span class="bu">event</span>) { <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="bu">event</span>)<span class="op">;</span> }</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;somebutton&quot;</span>)<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span>e<span class="kw">=&gt;</span>{</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        chan<span class="op">.</span><span class="fu">postMessage</span>(<span class="st">'This is a test message.'</span>)<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>      })</span></code></pre></div>
</section>
</section>
<section id="send-html-request-with-js" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Send HTML request with js</h1>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> xmlHttp <span class="op">=</span> <span class="kw">new</span> <span class="bu">XMLHttpRequest</span>()<span class="op">;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>xmlHttp<span class="op">.</span><span class="at">onreadystatechange</span> <span class="op">=</span> <span class="kw">function</span>() {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (xmlHttp<span class="op">.</span><span class="at">readyState</span> <span class="op">==</span> <span class="dv">4</span> <span class="op">&amp;&amp;</span> xmlHttp<span class="op">.</span><span class="at">status</span> <span class="op">==</span> <span class="dv">200</span>) {</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> response <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">parse</span>(xmlHttp<span class="op">.</span><span class="at">responseText</span>)<span class="op">;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">&quot;div&quot;</span>)<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> response<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="at">joke</span><span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>xmlHttp<span class="op">.</span><span class="fu">open</span>(<span class="st">&quot;GET&quot;</span><span class="op">,</span> <span class="st">&quot;https://api.icndb.com/jokes/random/&quot;</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>xmlHttp<span class="op">.</span><span class="fu">send</span>(<span class="kw">null</span>)<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> responseText <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="st">&quot;https://api.icndb.com/jokes/random/&quot;</span>)</span></code></pre></div>
<p>It’s nearly impossible to set a promise respone to a variable but much easier with <code>await</code></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> somePromise <span class="op">=</span> <span class="fu">fetch</span>(<span class="st">&quot;https://api.icndb.com/jokes/random/&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">// We still cant do anything with this</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> anotherPromise <span class="op">=</span> responseTextPromise<span class="op">.</span><span class="fu">then</span>(response <span class="kw">=&gt;</span> response<span class="op">.</span><span class="fu">text</span>())</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">// nope this just returns another promise</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> anotheranotherPromise <span class="op">=</span> anotherPromise<span class="op">.</span><span class="fu">then</span>(x <span class="kw">=&gt;</span> x)</span></code></pre></div>
<p>Notice when we use promises, this is no way to send the response to set a variable,<br />
all we can do is infinitely chaining with more <code>.then(..)</code> which just returns yet another promise</p>
</section>
<section id="select-element-by-class-or-id" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Select element by class or id</h1>
<div class="sourceCode" id="cb9"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">&quot;#content&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="st">&quot;new value&quot;</span><span class="op">;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">//this will select by id </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">&quot;.myclass&quot;</span>)<span class="op">;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">//this will select by class </span></span></code></pre></div>
</section>
<section id="more-complex-selector" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> More Complex selector</h1>
<div class="sourceCode" id="cb10"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">&quot;div.user-panel.main input[name='login']&quot;</span>)<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">class</span><span class="ot">=</span><span class="st">&quot;user-panel main&quot;</span><span class="kw">&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;input</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;login&quot;</span><span class="kw">/&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code></pre></div>
</section>
<section id="building-html-element-through-vanilla-js" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Building HTML element through vanilla JS</h1>
<div class="sourceCode" id="cb12"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> paragraph <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">&quot;p&quot;</span>)<span class="op">;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> textContent <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createTextNode</span>(<span class="st">&quot;content&quot;</span>)<span class="op">;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>paragraph<span class="op">.</span><span class="fu">appendChild</span>(textContent)<span class="op">;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">&quot;#messages&quot;</span>)<span class="op">.</span><span class="fu">appendChild</span>(paragraph)<span class="op">;</span></span></code></pre></div>
<hr />
</section>
<section id="promises-async-timeout" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Promises, Async, Timeout</h1>
<p>sdfs</p>
<hr />
<div class="sourceCode" id="cb13"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">navigator</span><span class="op">.</span><span class="at">geolocation</span><span class="op">.</span><span class="fu">getCurrentPosition</span>((loc)<span class="kw">=&gt;</span>{</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>loc<span class="op">.</span><span class="at">coords</span><span class="op">.</span><span class="at">latitude</span><span class="sc">}</span><span class="vs"> and </span><span class="sc">${</span>loc<span class="op">.</span><span class="at">coords</span><span class="op">.</span><span class="at">longitude</span><span class="sc">}</span><span class="vs">`</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>     })</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">//Local storage data is perm</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>localStorage<span class="op">.</span><span class="fu">setItem</span>(<span class="st">&quot;key&quot;</span><span class="op">,</span> <span class="st">&quot;someVal&quot;</span>)<span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>localStorage<span class="op">.</span><span class="fu">getItem</span>(<span class="st">&quot;key&quot;</span>)<span class="op">;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">//Session storage data gets deletd on browser close</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>sessionStorage<span class="op">.</span><span class="fu">setItem</span>(<span class="st">&quot;key&quot;</span><span class="op">,</span> <span class="st">&quot;someVal&quot;</span>)<span class="op">;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>sessionStorage<span class="op">.</span><span class="fu">getItem</span>(<span class="st">&quot;key&quot;</span>)<span class="op">;</span></span></code></pre></div>
<hr />
</section>
<section id="location.hash" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> location.hash</h1>
<p>Not the hash function!
Given a url: <code class="sourceCode javascript">https<span class="op">:</span><span class="co">//example.com/stuff#blah%20ads%20bah</span></code></p>
<p><code class="sourceCode javascript">location<span class="op">.</span><span class="at">hash</span></code> –&gt; <code class="sourceCode javascript">#blah<span class="op">%</span>20ads<span class="op">%</span>20bah</code></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="pp">decodeURIComponent</span>(location<span class="op">.</span><span class="at">hash</span><span class="op">.</span><span class="fu">substr</span>(<span class="dv">1</span>))</span></code></pre></div>
<hr />
</section>
<section id="js-for-react" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> JS for React</h1>
<ul>
<li>event object
<ul>
<li>React uses event as arguments to callbacks a lot</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> callback <span class="op">=</span> (e) <span class="kw">=&gt;</span> {</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> domTarget <span class="op">=</span> e<span class="op">.</span><span class="at">target</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(e<span class="op">.</span><span class="at">type</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Event#interfaces_based_on_event">List of event types</a></p>
</section>
<section id="web-apis" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Web apis</h1>
<ul>
<li>WebUSB Api - connect USB devices</li>
<li>WebGL - render interactive 3d graphics</li>
<li>Webassembly - native performance</li>
<li>Bluetooth Api - Connect to wireless device</li>
<li>Notification Api - Display system notification</li>
<li>Service Worker - Caching for offline usage</li>
<li>Web Workers - Multithread</li>
</ul>
</section>
<section id="this-and-bind" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> this and bind</h1>
<ul>
<li><code>this</code> is an OO construct that allows vision of the outer closure similar to <code>self</code> in python.
<ul>
<li><code>this</code> varys depending on where it is instantiated, assigned or called</li>
<li>On assignment to variable the <code>context</code> changes
<ul>
<li><code>let a = b</code> means <code>context</code> of <code>b</code> depends on where this assignment happened.</li>
</ul></li>
<li><code>.bind()</code> allows us change the <code>context</code>
<!--  --></li>
</ul></li>
<li>idiosyncrasy:<code>const f = ()=&gt;{}</code> keeps the <code>this</code> or <code>context</code> where the function was declared but <code>function(){}</code> does not.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">//global context</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> dog <span class="op">=</span> {</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">//dog context</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">sound</span> <span class="op">:</span> <span class="st">&quot;wolf&quot;</span><span class="op">,</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">talk</span> <span class="op">:</span> <span class="kw">function</span>(){ <span class="co">//note we didnt use arrow notation ()=&gt;{}</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="kw">this</span><span class="op">.</span><span class="at">sound</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">//'this' -&gt; dog context</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>dog<span class="op">.</span><span class="fu">talk</span>() <span class="co">// prints wolf</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> newdogtalk <span class="op">=</span> dog<span class="op">.</span><span class="at">talk</span> <span class="co">//we basically copied the talk function so </span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">//'this' now points to place of assignment which is global context</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">newdogtalk</span>() <span class="co">//output undefined since there is no 'sound' in global</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> newnewdogtalk <span class="op">=</span> (dog<span class="op">.</span><span class="at">talk</span>)<span class="op">.</span><span class="fu">bind</span>(dog) <span class="co">//bind forces 'this' to point to dog context</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">newnewdogtalk</span>() <span class="co">//output wolf</span></span></code></pre></div>
<section id="arrow-vs-function" class="level2" data-number="11.1">
<h2 data-number="11.1"><span class="header-section-number">11.1</span> Arrow vs function()</h2>
<ul>
<li>Arrows binds this to the lexical scope, meaning you can just look at the code and see what encloses the arrow function to understand what <code>this</code> points to.
<ul>
<li>static binding</li>
</ul></li>
<li>function() binds dynamically, meaning <code>this</code> depends on how the function is called at run time.
<ul>
<li>dynamic binding</li>
</ul></li>
</ul>
</section>
</section>
<section id="prototype-give-pseudo-class-functionality-to-js-functions" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Prototype give pseudo-class functionality to JS functions</h1>
<p>JS has a half-baked class system which doesn’t actually have interfaces or abstract methods/classes. All you can do is extend concrete classes with concrete classes.</p>
<ol type="1">
<li>JS functions can behave as pseudo-classes</li>
<li>prototype allows to add methods to this psuedo-classes</li>
<li>The <code>clone()</code> method in typical design pattern is just the <code>new</code> method applied to the JS pseudo-class</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">Car</span>(name) {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">this</span><span class="op">.</span><span class="at">name</span> <span class="op">=</span> name<span class="op">;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>Car<span class="op">.</span><span class="at">prototype</span><span class="op">.</span><span class="at">getName</span> <span class="op">=</span> <span class="kw">function</span>(){</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="kw">this</span><span class="op">.</span><span class="at">name</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">name</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> b <span class="op">=</span> <span class="kw">new</span> <span class="fu">Car</span>(<span class="st">&quot;sick&quot;</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>b<span class="op">.</span><span class="fu">getName</span>()</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> GenericPerson <span class="op">=</span> {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">greet</span>() {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`hello, my name is </span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">name</span><span class="sc">}</span><span class="vs">!`</span>)<span class="op">;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">Person</span>(name) {</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">this</span><span class="op">.</span><span class="at">name</span> <span class="op">=</span> name<span class="op">;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(Person<span class="op">.</span><span class="at">prototype</span><span class="op">,</span> GenericPerson)<span class="op">;</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">// or</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">// Person.prototype.greet = GenericPerson.greet;</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>THIS is very similar <span class="fu">to</span> <span class="vs">`Person extends GenericPerson`</span> <span class="kw">in</span> OOP terms</span></code></pre></div>
</section>

        </div>
        <div id="footer">
            <div class="flex-container" style="display:flex; justify-content: space-between;">
                <div>
                    Site proudly generated by
                    <a href="http://jaspervdj.be/hakyll">Hakyll</a>
                </div>
                <div class="pagehitscounter"> 
                    <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fuserjy.github.io&count_bg=%231FDBD9&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=true" />
                </div>
                <div xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://userjy.github.io/">Jason's Notes</a> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://userjy.github.io/">Jason Yang</a> is licensed under <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-ND 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nd.svg?ref=chooser-v1"></a></div>
  
            </div>
        </div>
        
    </body>
    <footer>
        <!-- CODE TAB START -->
        <script>
                    //Structure:
                    // Codeblock < Group/Grouplabel/subgrp < datagroupSet < allblocks

            const AllBlocksPre = document.querySelectorAll("[data-group]");
            const AllBlocks = [...AllBlocksPre]; //gets all codeblocks w/ and w/o group label
            const getUniqueSet = (TargetSet,dataAttr) => {
                //gets the set of attributes of an array of codeblocks aka TargetSet
                const temp = TargetSet.map((e) => (e.getAttribute(dataAttr))); 
                const temp2 = temp.filter((a)=>a); //remove nulls
                return [...new Set(temp2)];
            } 
            const datagroupSet = getUniqueSet(AllBlocks,"data-group") //remove nulls

            const getCodeBlocks = (datagroup) => {
                //return list of glabels CodeBlocks associated to a single group 
                return AllBlocks.filter((dataglabelBlock)=>(dataglabelBlock.getAttribute("data-group") === datagroup));
            }

            const showBlocks = (dataglabeltxt,datagroupCodeBlocks) => {
                const selectedglabelGroup = datagroupCodeBlocks.filter((SingleBlock)=>(SingleBlock.getAttribute("data-glabel") === dataglabeltxt))
                const NONselectedglabelGroup = datagroupCodeBlocks.filter((SingleBlock)=>(SingleBlock.getAttribute("data-glabel") !== dataglabeltxt))
                selectedglabelGroup.map((SingleBlock) => (SingleBlock.style.display="block"));
                (NONselectedglabelGroup || []).map((SingleBlock) => (SingleBlock.style.display="none"));
            }
            const mkBtn = (dataglabeltxt,datagroupCodeBlocks,showfunc) => {
                const newbutton = document.createElement("input");
                newbutton.type = "radio";
                // newbutton.textContent = dataglabeltxt;
                newbutton.addEventListener('click', ()=>{
                    // console.log(datagroupCodeBlocks)
                    showfunc(dataglabeltxt,datagroupCodeBlocks);
                });
                return newbutton;
            }
            const showAll = (datagroup) => {
                //make all codeblocks visible
            datagroup.map((e)=>(e.style.display="block"));
            }

            const buildCodeTab = (datagroupCodeBlocks,datagroup) => {
                const leaderCodeBlockDiv = datagroupCodeBlocks[0]; //get the leader codeblock of a group of codeblock
                const setglabelstxt = getUniqueSet(datagroupCodeBlocks,"data-glabel"); 
                setglabelstxt.map((singleglabeltxt)=>{
                    
                    const btn = mkBtn(singleglabeltxt,datagroupCodeBlocks,showBlocks);
                    btn.name = datagroup;
                    btn.id = datagroup+singleglabeltxt;
                    const radiolabelx = document.createElement("label");
                    radiolabelx.setAttribute("for",datagroup+singleglabeltxt);
                    radiolabelx.innerText = singleglabeltxt;
        
                    // leaderCodeBlockDiv.insertAdjacentElement("beforebegin",radiolabelx);
                    // radiolabelx.appendChild(btn);
                    const radioclass = document.createElement("div");
                    radioclass.className = "radioclass";
                    radioclass.appendChild(btn);
                    radioclass.appendChild(radiolabelx)
                    leaderCodeBlockDiv.insertAdjacentElement("beforebegin",radioclass);
                    // leaderCodeBlockDiv.prepend(btn);
                    
                    
                })
             
                // leaderCodeBlockDiv.append(btnlist);
                
                const btnShowAll = document.createElement("input");
                btnShowAll.type = "radio";
                btnShowAll.addEventListener('click',(e)=>(showAll(datagroupCodeBlocks)));

                btnShowAll.name = datagroup;
                btnShowAll.id = datagroup+"All";
                const radiolabel = document.createElement("label");
                radiolabel.setAttribute("for",datagroup+"All");
                radiolabel.innerText = "All";

                const radioclass = document.createElement("div");
                radioclass.className = "radioclass";
                radioclass.appendChild(btnShowAll);
                radioclass.appendChild(radiolabel)
                leaderCodeBlockDiv.insertAdjacentElement('beforebegin',radioclass);
                //make showAllbutton END
            }

            //below code is performing actual behavior, the above code are just functions
            datagroupSet.map((datagroup) => {
                
                const groupOfCodeblocks = getCodeBlocks(datagroup);
                buildCodeTab(groupOfCodeblocks,datagroup);
                const firsttab = groupOfCodeblocks[0];
                showBlocks(firsttab.getAttribute("data-glabel"),groupOfCodeblocks);
       
            })
        </script>
        <!-- CODE TAB END ---->

        <!-- MATH JAX START -------------------------------------- -->
        <script id="MathJax-script" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-chtml.min.js">
        </script>
        <!-- MATH JAX END ----------------------------------------- -->
        <!-- MERMAID START -------------------------------------- -->
        <script type="module"> 
            import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/+esm'
        </script>
        <!-- <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js" async></script> -->
        <!-- MERMAID END -------------------------------------- -->
        <!-- RAILROAD START -------------------------------------- -->
        <script type="module">
            import rr,* as rrClass from "/lib/railroad/railroad.js";
            Object.assign(window,rr)
            window.rrOptions = rrClass.Options;
            document.addEventListener('DOMContentLoaded',()=>{ReplaceDivWithSvg()},false)
            const ReplaceDivWithSvg = () =>  {
                for (const railroadelem of document.getElementsByClassName("rroad") ){
                railroadelem.innerHTML = eval(railroadelem.innerText.trim()+".toString()")
                }
            }
        </script>
        

        <link rel="stylesheet" href="../lib/railroad/railroad-diagrams.css">
        <!-- RAILROAD END ----------------------------------------- -->
    </footer>
</html>
