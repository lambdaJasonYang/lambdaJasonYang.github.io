---
title: Pen Testing 2
tags: tech
---

# hostapd - Create AP

* hostapd can create an accesspoint for other PCs to connect to

```txt
interface=wlan0mon
driver=nl80211
ssid=neighborAP
hw_mode=g
channel=8
macaddr_acl=0
ignore_broadcast_ssid=0
```

# dhcpd/dnsmasq - Assigning/Getting IPs

* dnsmasq is smaller/easier to use than dhcpd


```txt
DHCP CLIENT                         DHCP SERVER                    
PC                                      ROUTER
  
----DHCP DISCOVER(Got IPs?) --------->>>>>>
<<<<<<-----DHCP OFFER(U like this IP?)-----
----DHCP REQUEST(I want this IP)----->>>>>>
<<<<<-DHCP ACK(U r now known by this IP)---
```

## dhcpd

The router's leases it gives out are stored in `/var/lib/dhcp/dhcpd.leases`



## dnsmasq

```txt
#Set the wifi interface
interface=wlan0mon

#Set the IP range that can be given to clients
dhcp-range=10.0.0.10,10.0.0.100,255.255.255.0,8h

#Set the gateway IP address
dhcp-option=3,10.0.0.1

#Set DNS server address
dhcp-option=6,10.0.0.1

#Set Server
server=8.8.8.8

#logs
log-queries
log-dhcp

#Redirect all requests to 10.0.0.1
address=/#/10.0.0.1
```

# IPTABLES

```bash
iptables --flush
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE #tells us 
iptables --append FORWARD --in-interface wlan0mon -j ACCEPT 
iptables -t nat -A POSTROUTING -j MASQUERADE
echo 1 > /proc/sys/net/ipv4/ip_forward
```

