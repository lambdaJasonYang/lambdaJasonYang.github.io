<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="Content-Type" content="text/html" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- <meta
            http-equiv="Content-Security-Policy"
            content="default-src *" /> -->

        <!-- Icon start -->
        <link rel="icon" href="../images/icons/IconSheet.svg#browserlogo">
        <link rel="apple-touch-icon" href="../images/icons/IconSheet.svg#browserlogo">
        <link rel="shortcut icon" href="../images/icons/IconSheet.svg#browserlogo" />
        <link rel="mask-icon" href="../images/icons/IconSheet.svg#browserlogo" />
        <!-- Icon end -->

        <!-- Global site tag (gtag.js) - Google Analytics START ------------------->

        <!-- <script defer src="https://www.googletagmanager.com/gtag/js?id=G-2W1VXE5GSE"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-2W1VXE5GSE');
        </script> -->
        
        <!-- Global site tag (gtag.js) - Google Analytics END ---------------------->

        <!-- NO JS Behavior START -->
        <noscript>
            <style>
                nav.sidenav {display:none;}
                li.nav-item{display:none;}
            </style>
        </noscript>
         <!-- NO JS Behavior END -->

        <title>Jason Yang - Quick C</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
    </head>

    <body>
        <!-- Side navigation start -->
        <nav class="sidenav">
            <li class="logo">
                <a href="#" class="nav-link">
                    <span class="link-text logo-text">Jason</span>
                    <svg><use href="../images/icons/IconSheet.svg#sidebardod"></use></svg>
                </a>
            </li>
        
            
            <li class="nav-item">
                <a href="../tags/mathcs.html" class="nav-link">
                    <svg><use href="../images/icons/IconSheet.svg#lambda"></use></svg>
                    <span class="link-text">Math/CS</span>
                </a>
            </li>
                
            <li class="nav-item">
                <a href="../tags/prog.html" class="nav-link">
                    <svg><use href="../images/icons/IconSheet.svg#progcode"></use></svg>
                    <span class="link-text">Prog</span>
                </a>
            </li>


            <li class="nav-item">
                <a href="../tags/AI.html" class="nav-link">
                    <svg><use href="../images/icons/IconSheet.svg#AIbrain"></use></svg>
                    <span class="link-text">ML/AI</span>
                </a>
            </li>

            <li class="nav-item">
                <a href="../tags/tech.html" class="nav-link">
                    <svg><use href="../images/icons/IconSheet.svg#hardware"></use></svg>
                    <span class="link-text">Tech</span>
                </a>
            </li>

            <li class="nav-item">
                <a href="../tags/musings.html" class="nav-link">
                    <svg><use href="../images/icons/IconSheet.svg#thinker"></use></svg>
                    <span class="link-text">Musings</span>
                </a>
            </li>


            <li class="nav-item">
                <a href="https://github.com/lambdaJasonYang" class="nav-link">
                    <svg><use href="../images/icons/IconSheet.svg#github"></use></svg>
                    <span class="link-text">Github</span>
                </a>
            </li>
        </nav>
        <!-- Side navigation end -->
        <div id="header">
            <div id="logo">
                <a href="../">Jason Yang</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </div>
        </div>

        <div id="content">
            <h1>Quick C</h1>
            

            <div class="info">
    Posted on July  1, 2014
    
</div>
<div class="info">
    
    Tags: <a title="All pages tagged 'prog'." href="../tags/prog.html">prog</a>, <a title="All pages tagged 'C'." href="../tags/C.html">C</a>, <a title="All pages tagged 'QuickCode'." href="../tags/QuickCode.html">QuickCode</a>, <a title="All pages tagged 'OS'." href="../tags/OS.html">OS</a>
    
</div>
<p>Remember pointers always hold an address so if you’re reading some spec,<br />
replace pointer with address if it gets confusing.</p>
<blockquote>
<p>function bleh that takes a pointer can be read as this function is directly accessing or modifying the object</p>
</blockquote>
<section id="basics" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Basics</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> <span class="op">*</span>str <span class="op">=</span> <span class="st">&quot;Hello&quot;</span><span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode txt"><code class="sourceCode default"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>        +----+----+---+---+---+---+---+----+----+----+</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Memory: | .. | .. | H | e | l | l | o | \0 | .. | .. |</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        +----+----+---+---+---+---+---+----+----+----+</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                    ^</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                   str</span></code></pre></div>
<p>standard library is nested in angled brackets like &lt;iostream&gt; &lt;stdio.h&gt;</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> b <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>a <span class="op">=</span> <span class="op">&amp;</span>b<span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;address of pointee b aka value of a is %p  </span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> a<span class="op">);</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;value of pointee is b  </span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">*(</span><span class="dt">int</span><span class="op">*)(</span>a<span class="op">));</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">//address of pointee b aka value of a is 0xbefe3588</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">//value of pointee b is 5 </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;An int is %d, A long is %ld, a float is %f, a double is %lf, a char is %c, a string is %s, a pointer is %p&quot;</span><span class="op">,</span><span class="dv">12</span><span class="op">,</span><span class="dv">25555555</span><span class="op">,</span><span class="fl">23.1</span><span class="op">,</span><span class="fl">23.01</span><span class="op">,</span><span class="ch">'c'</span><span class="op">,</span><span class="st">&quot;asd&quot;</span><span class="op">,</span>a<span class="op">)</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th>printf</th>
<th>keywords</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>%c</td>
<td>char</td>
</tr>
<tr class="even">
<td>%s</td>
<td>string</td>
</tr>
<tr class="odd">
<td>%d,%ld</td>
<td>int,long</td>
</tr>
<tr class="even">
<td>%f</td>
<td>float</td>
</tr>
<tr class="odd">
<td>%lf</td>
<td>double</td>
</tr>
<tr class="even">
<td>%p</td>
<td>pointer value aka address of pointee</td>
</tr>
<tr class="odd">
<td>%x</td>
<td>convert unsigned number to hex</td>
</tr>
<tr class="even">
<td>%o</td>
<td>convert unsigned number to octal</td>
</tr>
</tbody>
</table>
</section>
<section id="macros" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> MACROS</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef two</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define two 2</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a <span class="op">=</span> two<span class="op">;</span></span></code></pre></div>
<p>ifndef tells us if not defined then define it else skip it.</p>
<p><code class="sourceCode c"><span class="pp">#define MAX(a,b) a &gt; b ? a : b</span></code></p>
<hr />
</section>
<section id="example-linking-multiple-object-files" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Example linking multiple object files</h1>
<div class="sourceCode" id="cb5" data-filename="main.c"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;helper.h&quot;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef two</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#define two 2</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a <span class="op">=</span> two<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;hey %d &quot;</span><span class="op">,</span> plus<span class="op">(</span>a<span class="op">,</span><span class="dv">3</span><span class="op">));</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb6" data-filename="helper.h"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#ifndef avoidRepeatImport</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define avoidRepeatImport</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> plus<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">);</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#endif</span></span></code></pre></div>
<div class="sourceCode" id="cb7" data-filename="helper.c"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;helper.h&quot;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> plus<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">){</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Below, the “-c” flag tells us to convert helper.c to helper.o</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gcc</span> <span class="at">-c</span> helper.c <span class="co">#outputs helper.o</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gcc</span> <span class="at">-c</span> main.c <span class="co">#outputs main.o</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gcc</span> main.o helper.o <span class="at">-o</span> myexecutable</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="ex">./myexecutable</span></span></code></pre></div>
<p>Alternatively we can just do</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gcc</span> main.c helper.c <span class="at">-o</span> myexecutable <span class="at">-Wall</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./myexecutable</span>    </span></code></pre></div>
</section>
<section id="makefile" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> makefile</h1>
<ul>
<li>“make” is analogous to “npm build”<br />
</li>
<li>“makefile” is analogous to “package.json”</li>
</ul>
<p>On Vscode bottom right click on Spaces and turn to tab.<br />
make requires tab before gcc command.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> <span class="at">-e</span> <span class="at">-t</span> <span class="at">-v</span> makefile <span class="co">#Use to check for tabs ^I</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> <span class="co">#this will build the makefile</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">all:</span> run</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>	<span class="fu">gcc</span> main.o </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>	<span class="ex">./a.out</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="ex">run:</span> main.c</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>	<span class="fu">gcc</span> <span class="at">-c</span> main.c</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="ex">clean:</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>	<span class="fu">rm</span> a.out main.o</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">all:</span> main.o helper.o</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>	<span class="fu">gcc</span> main.o helper.o <span class="at">-o</span> myexecutable</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="ex">main.o:</span> main.c helper.h</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>	<span class="fu">gcc</span> <span class="at">-c</span> main.c</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="ex">helper.o:</span> helper.c helper.h</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>	<span class="fu">gcc</span> <span class="at">-c</span> helper.c</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="ex">clean:</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>	<span class="fu">rm</span> helper.o main.o myexecutable</span></code></pre></div>
<ul>
<li>the all keyword will always run.
<ul>
<li>all: main.o …</li>
<li>therefore the make will go to<br />
main.o main.o: &lt;Dependency1&gt; &lt;Dependency2&gt;…</li>
</ul></li>
</ul>
</section>
<section id="null-pointers-structs" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> null pointers, structs</h1>
<ul>
<li>uninitialized base variables and pointer are both <code>NULL</code> when read</li>
<li>uninitalized struct are also <code>NULL</code> when read</li>
<li>but <strong>members of uninitalized struct variables have random value</strong> and addresses(if the member is a pointer)</li>
<li><strong>but members of uninitalized struct pointers always give seg fault</strong></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> ll <span class="op">{</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> var<span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span><span class="op">*</span> ll next<span class="op">;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> ll newlist<span class="op">;</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;%d&quot;</span><span class="op">,</span>newlist<span class="op">);</span> <span class="co">// 0</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;%p&quot;</span><span class="op">,</span>newlistptr<span class="op">);</span> <span class="co">// (nil)</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;%d&quot;</span><span class="op">,</span>newlist<span class="op">.</span>next<span class="op">);</span> <span class="co">// 1824314</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;%p&quot;</span><span class="op">,</span>newlistptr<span class="op">.</span>next<span class="op">);</span> <span class="co">// 0x294452u205</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> ll<span class="op">*</span> newlistptr<span class="op">;</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;%d&quot;</span><span class="op">,</span>newlistptr<span class="op">);</span> <span class="co">// 0</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;%p&quot;</span><span class="op">,</span>newlistptr<span class="op">);</span> <span class="co">// (nil)</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;%d&quot;</span><span class="op">,(*</span>newlistptr<span class="op">).</span>next<span class="op">);</span> <span class="co">// segfault</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;%p&quot;</span><span class="op">,(*</span>newlistptr<span class="op">).</span>next<span class="op">);</span> <span class="co">// segfault</span></span></code></pre></div>
</section>
<section id="strings" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Strings</h1>
<ul>
<li>String is just a pointer to a character</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> <span class="op">*</span>str<span class="op">;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>str <span class="op">=</span> <span class="st">&quot;name&quot;</span></span></code></pre></div>
<ul>
<li><code>"name"</code> is actually the address of the beginning of the array <code>['n','a','m','e','\0']</code>
<ul>
<li>this means <code>str</code> points to the first character in <code>'n'</code> in the array</li>
</ul></li>
</ul>
<section id="string-literals-are-immutable-in-memory" class="level4" data-number="6.0.0.1">
<h4 data-number="6.0.0.1"><span class="header-section-number">6.0.0.1</span> String literals are immutable in memory</h4>
<ul>
<li>Typing a string like “hello” in your code editor means your progam will allocate a permanent address and memory for “hello” that all other
“hello” in your code will refer to.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;%s&quot;</span><span class="op">,</span><span class="st">&quot;hello&quot;</span><span class="op">);</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">//init string literal &quot;hello&quot; at SOME address </span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">//0xfffeee -&gt; &quot;hello&quot;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;%s&quot;</span><span class="op">,</span><span class="st">&quot;hello&quot;</span><span class="op">);</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">//REUSE same string literal at SAME address</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">//0xfffeee -&gt; &quot;hello&quot;</span></span></code></pre></div>
</section>
<section id="different-ways-to-init-string" class="level4" data-number="6.0.0.2">
<h4 data-number="6.0.0.2"><span class="header-section-number">6.0.0.2</span> Different ways to init String</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> s<span class="op">[</span><span class="dv">256</span><span class="op">];</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">//MUTABLE array of 256 initialized.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> s<span class="op">[</span><span class="dv">256</span><span class="op">]</span> <span class="op">=</span> <span class="st">&quot;hello&quot;</span><span class="op">;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>s<span class="op">[</span><span class="dv">1</span><span class="op">]=</span><span class="ch">'Y'</span><span class="op">;</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">//RHS: immutable string literal &quot;hello&quot; is initialized</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">//LHS: MUTABLE array s of 256 initialized.</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">//Copies string( and Auto appends a terminating \0) </span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">//RESULT: &quot;hello\0&quot; MUTABLE</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> s<span class="op">[]</span> <span class="op">=</span> <span class="st">&quot;hello&quot;</span><span class="op">;</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>s<span class="op">[</span><span class="dv">1</span><span class="op">]=</span><span class="ch">'Y'</span><span class="op">;</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">//RHS: immutable string literal &quot;hello&quot; is initialized</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">//LHS: automatically initialized 8 bytes MUTABLE array s.</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">//Copies string(and Auto append a terminating \0) </span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">//RESULT: &quot;hello\0&quot; MUTABLE</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> <span class="op">*</span>s <span class="op">=</span> <span class="st">&quot;hello&quot;</span><span class="op">;</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="op">*(</span>s<span class="op">+</span><span class="dv">1</span><span class="op">)=</span><span class="ch">'Y'</span><span class="op">;</span> <span class="co">//Crash trying to change 'e' =&gt; 'Y'</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">//RHS: immutable string literal &quot;hello&quot; is initialized</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">//LHS: s POINTS to IMMUTABLE string</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co">//We Crash for trying to modify an immutable string literal</span></span></code></pre></div>
<hr />
</section>
<section id="dynamic-mem-allocation" class="level3" data-number="6.0.1">
<h3 data-number="6.0.1"><span class="header-section-number">6.0.1</span> Dynamic mem allocation</h3>
<p>malloc(size_t x)
allocates x bytes of heap memory
return address for x
return a void pointer, void <em>
int </em>a;
a = malloc(5 * sizeof(int));</p>
<p>free(void * p)
release dynamically allocated memory
input: pointer[aka address] to the beginning of a dynamically allocated block of memory</p>
<p>calloc(size_t n, size_t x)
basically just malloc with n*x bytes of memory</p>
<p>realloc(void *p, size_t x)
p must point to beginning of block
reallocate memory to x size.</p>
<p>GDB
must compile with -g
gcc -g …
gdb someprogram</p>
<p>run</p>
</section>
<section id="file-functions" class="level2" data-number="6.1">
<h2 data-number="6.1"><span class="header-section-number">6.1</span> file functions</h2>
<p>&lt;fcntl.h&gt;
open
add a . file to file table returns file descriptor
if open fails =&gt; -1</p>
<p>open(path,flags, mode)
* mode - basically file permission like 777
* used in file creation
* flags - what to do with file
* O_RDONLY
* O_WRONLY
* O_RDWR
* O_CREAT</p>
<p>&lt;sys/stat.h&gt;
umask
set file creation for all files;
umask(777); //gives all new file that will be created full permission</p>
<p>&lt;unistd.h&gt;
read data from file
read(filename, buffer , size)
read size bytes from filename into buffer</p>
<p>&lt;unistd.h&gt;
write(filename,buffer,size)</p>
<p>&lt;unistd.h&gt;
lseek
set current position in open file
lseek(file_descriptor, offset,whence)
* offset - number of bytes to move position by, (-inf,inf)
* whence - where to measure offset from
* SEEK_SET - beginning of file
* SEEK_CUR - current position in file
* SEEK)END - end of file</p>
<p>&lt;sys/stat.h&gt;
stat(path , stat_buffer )
get information about a file</p>
</section>
<section id="directories" class="level2" data-number="6.2">
<h2 data-number="6.2"><span class="header-section-number">6.2</span> DIRECTORIES</h2>
<p>&lt;dirent.h&gt;
opendir
<em>Open a directory file
opendir( path);
returns a pointer to a directory stream typed “DIR </em>”</p>
<p>closedir(dir_stream)
closes directory stream and frees the pointer</p>
<p>readdir(dir_stream)
returns pointer to next entry in a directory stream or NULL if all entries have already been returned.</p>
<p>rewinddir(DIR * d)</p>
<pre><code>resets directory stream of d to the beginngin</code></pre>
<p>INPUT OUTPUT
int main( int argc, char *argv[] )
argc - number of command line args
argv - array of command line args as strings</p>
<p>stdin input
&lt;stdio.h&gt;
fgets(char * s, int size, FILE * f)
reads size-1 characters fomr file stream f and stores it in s and appends NULL.
stops at newline, EOF.
File stream has type “FILE <em>”
</em> more complex than file descriptor
<em>stdin is a universal FILE </em> variable
fgets(s,100 stdin);</p>
</section>
<section id="signals" class="level2" data-number="6.3">
<h2 data-number="6.3"><span class="header-section-number">6.3</span> Signals</h2>
<p>kill(pid,signal)</p>
<p>sighandler is basically a callback function you define.
static void sighandler (int signo )
intercept signals in a c program, cannot catch SIGKILL,SIGSTOP</p>
<p>signal(SIGNUMBER, sighandler)
attach a signal to a signal handling function</p>
<p>static void sighandler(int signo){
if (signo == SIGUSR1 )
printf(“YO”);
}
signal(SIGUSR1,sighandler);</p>
<p>Exec - c functions that run other proc or replace current proc with anothe proc
&lt;unistd.h&gt;</p>
<p>execl(path, command ,arg0, arg1 .. )</p>
<p>execlp(path, command, arg0,arg1 ..)
same as execlp but uses $PATH environment variables</p>
<p>Managing Sub-processes</p>
<p>&lt;unistd.h&gt;
fork()</p>
<p>&lt;sys/wait.h&gt;
wait(status)
stops parent process until child exited
return pid of child exited
* status
* WIFEEXITED - true if exit normally
* WEXITSTATUS - return value of child
* WIFSIGNALED - true if exit with signal
* WTERMSIG - signal number intercepted dby child</p>
<p>waidpid(pid,status,options)
wait for specific child</p>
</section>
<section id="redirection" class="level2" data-number="6.4">
<h2 data-number="6.4"><span class="header-section-number">6.4</span> Redirection</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>unistd<span class="op">.</span>h<span class="op">&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>dup2<span class="op">(</span>fd1<span class="op">,</span>fd2<span class="op">)</span></span></code></pre></div>
<ul>
<li>redirects fd2 to fd1</li>
</ul>
</section>
<section id="pipes" class="level2" data-number="6.5">
<h2 data-number="6.5"><span class="header-section-number">6.5</span> Pipes</h2>
<p>A conduit between 2 separate processes on the same computer.<br />
Pipes have 2 ends, a read end and a write end.<br />
Pipes act just like files (i.e. you can read() and write() to send any kind of data).<br />
Pipes exist in memory.</p>
<section id="unnamed-pipes" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1"><span class="header-section-number">6.5.1</span> Unnamed Pipes</h3>
<p>Unnamed pipes have no external identifier.<br />
pipe - &lt;unistd.h&gt;<br />
Create an unnamed pipe.<br />
Returns 0 if the pipe was created, -1 if not.</p>
</section>
<section id="pipe-descriptors" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2"><span class="header-section-number">6.5.2</span> pipe( descriptors )</h3>
<p>descriptors<br />
Array that will contain the descriptors for each end of the pipe. Must be an int array of size 2.<br />
descriptors[0] is the read end.<br />
descriptors[1] is the write end.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fds<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>pipe<span class="op">(</span> fds <span class="op">);</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> line<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> fork<span class="op">();</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>f <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  close<span class="op">(</span> fds<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">);</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  write<span class="op">(</span> fds<span class="op">[</span><span class="dv">1</span><span class="op">],</span> <span class="st">&quot;hello!&quot;</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> <span class="op">{</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  close<span class="op">(</span> fds<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">);</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  read<span class="op">(</span> fds<span class="op">[</span><span class="dv">0</span><span class="op">],</span> line<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>line<span class="op">)</span> <span class="op">);</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</section>
<section id="named-pipes" class="level3" data-number="6.5.3">
<h3 data-number="6.5.3"><span class="header-section-number">6.5.3</span> Named Pipes</h3>
<p>Also known as FIFOs.<br />
Same as unnamed pipes except FIFOs have a name that can be used to identify them via different programs.<br />
Like unnamed pipes, FIFOS are unidirectional.</p>
</section>
<section id="mkfifo" class="level3" data-number="6.5.4">
<h3 data-number="6.5.4"><span class="header-section-number">6.5.4</span> mkfifo</h3>
<p>Shell command to make a FIFO<br />
$ mkfifo name<br />
mkfifo - &lt;sys/types.h&gt; &lt;sys/stat.h&gt;<br />
c function to create a FIFO<br />
Returns 0 on success and -1 on failure<br />
Once created, the FIFO acts like a regular file, and we can use open, read, write, and close on it.<br />
FIFOs will block on open until both ends of the pipe have a connection.<br />
mkfifo( name, permissions )</p>
</section>
<section id="shared-memory" class="level3" data-number="6.5.5">
<h3 data-number="6.5.5"><span class="header-section-number">6.5.5</span> Shared Memory</h3>
<p>&lt;sys/shm.h&gt; &lt;sys/ipc.h&gt; &lt;sys/types.h&gt;<br />
A segment of heap memory that can be accessed by multiple processes.<br />
Shared memory is accessed via a key that is known by any process that needs to access it.<br />
Shared memory does not get released when a program exits.`</p>
<ul>
<li>5 Shared memory operations</li>
<li>Create the segment (happens once) - shmget</li>
<li>Access the segment (happens once per process) - shmget</li>
<li>Attach the segment to a variable (once per process) - shmat</li>
<li>Detach the segment from a variable (once per process) - shmdt</li>
<li>Remove the segment (happens once) - shmctl</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>data<span class="op">;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> shmd<span class="op">;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>shmd <span class="op">=</span> shmget<span class="op">(</span>KEY<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">int</span><span class="op">),</span> IPC_CREAT <span class="op">|</span> <span class="bn">0640</span><span class="op">);</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;shmd: %d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> shmd<span class="op">);</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> shmat<span class="op">(</span>shmd<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;data: %p</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> data<span class="op">);</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;*data: %d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">*</span>data<span class="op">);</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="op">*</span>data <span class="op">=</span> <span class="op">*</span> data <span class="op">+</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>printf<span class="op">(</span><span class="st">&quot;*data: %d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">*</span>data<span class="op">);</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>shmdt<span class="op">(</span>data<span class="op">);</span> </span></code></pre></div>
<p>Server Design</p>
<ul>
<li>Handshake - ensure a connection between 2 programs</li>
<li>3-way-handshake - verify both client and server can BOTH SEND AND RECIEVE DATA</li>
<li>Client send msg to Server. (lets server know client can recieve data)</li>
<li>NOTE: At this point Server DOES NOT KNOW if client can send data<br />
</li>
<li>Server send resp to Client. (Let client know Server can recieve and send data)</li>
<li>Client send resp to Server. (lets server know client can recieve and send data)</li>
</ul>
<p>Setup</p>
<ul>
<li>Server creates a FIFO (Well Known Pipe) and waits for a connection.</li>
<li>Client creates a “private” FIFO.</li>
</ul>
<p><code>sprintf(buffer, "%d", getpid() );</code></p>
<p>Handshake</p>
<ul>
<li>Client connects to server and sends the private FIFO name.</li>
<li>Client waits for a response from the server.</li>
<li>Server receives client’s message and removes the WKP.</li>
<li>Server connects to client FIFO, sending an initial acknowledgement message.</li>
<li>Client receives server’s message, removes its private FIFO.</li>
<li>Client sends response to server.</li>
</ul>
<p>Operation</p>
<ul>
<li>Server and client send information back and forth.</li>
</ul>
<p>Reset</p>
<ul>
<li>Client exits, server closes any connections to the client.</li>
<li>Server recreates the WKP waits for another client.</li>
</ul>
</section>
</section>
</section>
<section id="assembly-mov-vs-lea" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Assembly MOV vs LEA</h1>
<p>lea just mov but don’t dereference the source argument</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode txt"><code class="sourceCode default"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mov eax, var       == lea eax, [var]   ; i.e. mov r32, imm32</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>lea eax, [var+16]  == mov eax, var+16</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>lea eax, [eax*4]   == shl eax, 2        ; but without setting flags</span></code></pre></div>
</section>
<section id="c-string-vs-preprocessor-string" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> C-string vs Preprocessor string</h1>
<div class="sourceCode" id="cb23"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> square<span class="op">()</span> <span class="op">{</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> hello<span class="op">[]</span> <span class="op">=</span> <span class="st">&quot;WORLD&quot;</span><span class="op">;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    puts<span class="op">(</span> hello<span class="op">);</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode txt"><code class="sourceCode default"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>square:</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    //function call pushes stuff to stackframe</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>        push    rbp</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        mov     rbp, rsp</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        sub     rsp, 16</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    //char hello[] = &quot;WORLD&quot;;</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        mov     DWORD PTR [rbp-6], 1280462679</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        mov     WORD PTR [rbp-2], 68</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    //puts(hello);</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        lea     rax, [rbp-6]   </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        mov     rdi, rax</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        call    puts</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    //exit function</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>        nop</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>        leave</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>        ret</span></code></pre></div>
<p><code>mov     DWORD PTR [rbp-6], 1280462679</code><br />
Hex(1280462679) = 0x4C524F57<br />
Split up 0x4C524F57 every 2 hex: 4C 52 4F 57
Translate 4C 52 4F 57 to ASCII: <code>L R O W</code></p>
<p><code>mov     WORD PTR [rbp-2], 68</code><br />
Hex(68) = 0x44<br />
Translate 0x44 to ASCII: <code>D</code></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode txt"><code class="sourceCode default"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Higher Address</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>+------------------------+</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>|        [rbp-2]         |   &lt;- WORD (2 bytes) containing ASCII 'D' (68 in hex)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>+------------------------+</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>|        [rbp-6]         |   &lt;- DWORD (4 bytes) containing ASCII 'LROW' (1280462679 in hex)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>+------------------------+</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>|          ...           |   &lt;- Other stack data</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>|          ...           |</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>Lower Address</span></code></pre></div>
<p>WORLD spelled backwards, since it is pushed into the stack</p>
<p>Below uses a preprocessor string</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define hello &quot;WORLD&quot;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> square<span class="op">()</span> <span class="op">{</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    puts<span class="op">(</span>hello<span class="op">);</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode txt"><code class="sourceCode default"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>.LC0:</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>        .string &quot;WORLD&quot;</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>square:</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    //function call pushes stuff to stackframe</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        push    rbp</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        mov     rbp, rsp</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    //preprocessor #define hello &quot;WORLD&quot;</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        mov     edi, OFFSET FLAT:.LC0</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    //puts(hello);</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        call    puts</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    //exit function</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        nop</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        pop     rbp</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        ret</span></code></pre></div>
<p>We see that the variable allocated char[] takes spaces of <code>rdi</code><br />
while the proprocessor allocated string takes space of <code>edi</code></p>
</section>
<section id="fork-example" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> fork example</h1>
<div class="sourceCode" id="cb28"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> commonVar <span class="op">=</span> getpid<span class="op">();</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a<span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>b <span class="op">=</span> <span class="op">&amp;</span>a<span class="op">;</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;%d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span>commonVar<span class="op">);</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// sleep(100);</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> soul <span class="op">=</span> fork<span class="op">();</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>soul <span class="op">==</span> <span class="dv">0</span><span class="op">){</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a <span class="op">*</span><span class="dv">3</span><span class="op">;</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>b <span class="op">=</span> <span class="op">*</span>b <span class="op">*</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;commonVar: %d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span>commonVar<span class="op">);</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;pid: %d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span>getpid<span class="op">());</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;a:%d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> a<span class="op">);</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>soul <span class="op">!=</span> <span class="dv">0</span><span class="op">){</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        a <span class="op">=</span> a <span class="op">+</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>b <span class="op">=</span> <span class="op">*</span>b <span class="op">*</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;commonVar: %d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span>commonVar<span class="op">);</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;pid: %d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span>getpid<span class="op">());</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;a:%d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> a<span class="op">);</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="co">// 2442774</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="co">// commonVar: 2442774</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="co">// pid: 2442774</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="co">// a:6</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="co">// commonVar: 2442774</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="co">// pid: 2442775</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="co">// a:15</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a><span class="co">//Notice when the process is forked, everything gets duplicated</span></span></code></pre></div>
</section>
<section id="pthread-example" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> pthread Example</h1>
<div class="sourceCode" id="cb29"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;pthread.h&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span><span class="op">*</span> func<span class="op">(</span><span class="dt">void</span><span class="op">*</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> xi <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>x<span class="op">;</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Inside thread; x = %d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> xi<span class="op">);</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">*)(</span>xi <span class="op">+</span> <span class="dv">123</span><span class="op">);</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">char</span><span class="op">**</span> argv<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    pthread_t th<span class="op">;</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    pthread_create<span class="op">(&amp;</span>th<span class="op">,</span> NULL<span class="op">,</span> func<span class="op">,</span> <span class="op">(</span><span class="dt">void</span><span class="op">*)</span><span class="dv">100</span><span class="op">);</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span><span class="op">*</span> ret_from_thread<span class="op">;</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ri<span class="op">;</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    pthread_join<span class="op">(</span>th<span class="op">,</span> <span class="op">&amp;</span>ret_from_thread<span class="op">);</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    ri <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>ret_from_thread<span class="op">;</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Outside thread, which returned %d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> ri<span class="op">);</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</section>
<section id="write-to-file-example" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Write to file example</h1>
<div class="sourceCode" id="cb30"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span><span class="pp"> </span><span class="co">//calloc</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;unistd.h&gt;</span><span class="pp"> </span><span class="co">//POSIX write</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;fcntl.h&gt;</span><span class="pp"> </span><span class="co">//open</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="dt">size_t</span> strlen<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>s<span class="op">){</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">size_t</span> cnt <span class="op">=</span> <span class="dv">0</span> <span class="op">;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span> s<span class="op">[</span>cnt<span class="op">]</span> <span class="op">!=</span> <span class="ch">'\0'</span><span class="op">){</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        cnt<span class="op">++;</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cnt<span class="op">;</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> writeTerminal<span class="op">(){</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">//printf prins AFTER the `hey` buf gets printed</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Because printf is BUFFERED</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Writing directly to stdout printed last</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span> </span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="ch">'h'</span><span class="op">;</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="ch">'e'</span><span class="op">;</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="ch">'y'</span><span class="op">;</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="ch">'\n'</span><span class="op">;</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">//write is POSIX, fwrite is for all OS</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    write<span class="op">(</span><span class="dv">1</span><span class="op">,</span>buf<span class="op">,</span><span class="dv">4</span><span class="op">);</span> <span class="co">//1 means stdout</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    write<span class="op">(</span><span class="dv">2</span><span class="op">,</span>buf<span class="op">,</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    write<span class="op">(</span><span class="dv">0</span><span class="op">,</span>buf<span class="op">,</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    write<span class="op">(</span><span class="dv">3</span><span class="op">,</span>buf<span class="op">,</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> writeNreadFile<span class="op">(){</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Writing to file</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="op">*</span>buf <span class="op">=</span> <span class="op">(</span><span class="dt">char</span><span class="op">*)</span> calloc<span class="op">(</span><span class="dv">100</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">char</span><span class="op">));</span> <span class="co">//calloc is just malloc but zero'd out</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">//! WRITING TO FILE</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> fhandle<span class="op">;</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>    fhandle <span class="op">=</span> open<span class="op">(</span><span class="st">&quot;bleh.txt&quot;</span><span class="op">,</span>O_RDWR <span class="op">|</span> O_CREAT<span class="op">);</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;%p</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span>fhandle<span class="op">);</span> </span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> response <span class="op">=</span> write<span class="op">(</span>fhandle<span class="op">,</span> <span class="st">&quot;hilo</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> strlen<span class="op">(</span><span class="st">&quot;hilo&quot;</span><span class="op">));</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>    close<span class="op">(</span>fhandle<span class="op">);</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">//! READING TO FILE    </span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> writeNreadFile2<span class="op">(){</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="op">*</span>buf <span class="op">=</span> <span class="op">(</span><span class="dt">char</span><span class="op">*)</span> calloc<span class="op">(</span><span class="dv">100</span><span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">char</span><span class="op">));</span> <span class="co">//calloc is just malloc but zero'd out</span></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>    <span class="dt">FILE</span><span class="op">*</span> fhandle<span class="op">;</span></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>    fhandle <span class="op">=</span> fopen<span class="op">(</span><span class="st">&quot;bleh2.txt&quot;</span><span class="op">,</span> <span class="st">&quot;w+&quot;</span><span class="op">);</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;%d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,*</span>fhandle<span class="op">);</span></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>    fprintf<span class="op">(</span>fhandle<span class="op">,</span><span class="st">&quot;this is content&quot;</span><span class="op">);</span></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>    fclose<span class="op">(</span>fhandle<span class="op">);</span></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> readRandom<span class="op">(){</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> randFile <span class="op">=</span> open<span class="op">(</span><span class="st">&quot;/dev/random&quot;</span><span class="op">,</span> O_RDONLY<span class="op">);</span></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unsigned</span> <span class="dt">char</span> s<span class="op">;</span></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>    read<span class="op">(</span>randFile<span class="op">,</span> <span class="op">&amp;</span>s<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span><span class="dt">char</span><span class="op">));</span></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;%d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span>s<span class="op">);</span></span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>    close<span class="op">(</span>randFile<span class="op">);</span></span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a><span class="co">//!write will printout</span></span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(){</span>   </span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>    writeTerminal<span class="op">();</span></span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>    writeNreadFile<span class="op">();</span></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>    writeNreadFile2<span class="op">();</span></span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>    readRandom<span class="op">();</span></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</section>
<section id="deadlock-example" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Deadlock example</h1>
<div class="sourceCode" id="cb31"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;pthread.h&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span><span class="op">*</span> func2<span class="op">(</span><span class="dt">void</span><span class="op">*</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> xi <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>x<span class="op">;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Inside thread; x = %d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> xi<span class="op">);</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    sleep<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">*)(</span>xi <span class="op">+</span> <span class="dv">1233</span><span class="op">);</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span><span class="op">*</span> func<span class="op">(</span><span class="dt">void</span><span class="op">*</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> xi <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>x<span class="op">;</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Inside thread; x = %d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> xi<span class="op">);</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">*)(</span>xi <span class="op">+</span> <span class="dv">123</span><span class="op">);</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">char</span><span class="op">**</span> argv<span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    pthread_t th<span class="op">;</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    pthread_t th2<span class="op">;</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    pthread_create<span class="op">(&amp;</span>th<span class="op">,</span> NULL<span class="op">,</span> func<span class="op">,</span> <span class="op">(</span><span class="dt">void</span><span class="op">*)</span><span class="dv">100</span><span class="op">);</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    pthread_create<span class="op">(&amp;</span>th2<span class="op">,</span> NULL<span class="op">,</span> func2<span class="op">,</span> <span class="op">(</span><span class="dt">void</span><span class="op">*)</span><span class="dv">100</span><span class="op">);</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">void</span><span class="op">*</span> ret_from_thread<span class="op">;</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ri<span class="op">;</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    pthread_join<span class="op">(</span>th<span class="op">,</span> <span class="op">&amp;</span>ret_from_thread<span class="op">);</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>    pthread_join<span class="op">(</span>th2<span class="op">,</span> <span class="op">&amp;</span>ret_from_thread<span class="op">);</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>    ri <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>ret_from_thread<span class="op">;</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Outside thread, which returned %d</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> ri<span class="op">);</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<section id="list-all-files-in-directory" class="level2" data-number="12.1">
<h2 data-number="12.1"><span class="header-section-number">12.1</span> list all files in directory</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdlib.h&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;dirent.h&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> listFiles<span class="op">(</span><span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>basePath<span class="op">,</span> <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>relativePath<span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> path<span class="op">[</span><span class="dv">1024</span><span class="op">];</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> dirent <span class="op">*</span>entry<span class="op">;</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    DIR <span class="op">*</span>dir <span class="op">=</span> opendir<span class="op">(</span>basePath<span class="op">);</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>dir<span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>        perror<span class="op">(</span><span class="st">&quot;Error opening directory&quot;</span><span class="op">);</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        exit<span class="op">(</span>EXIT_FAILURE<span class="op">);</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">((</span>entry <span class="op">=</span> readdir<span class="op">(</span>dir<span class="op">))</span> <span class="op">!=</span> NULL<span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>entry<span class="op">-&gt;</span>d_name<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">==</span> <span class="ch">'.'</span><span class="op">)</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span> <span class="co">// Skip &quot;.&quot; and &quot;..&quot;</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        snprintf<span class="op">(</span>path<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>path<span class="op">),</span> <span class="st">&quot;%s/%s&quot;</span><span class="op">,</span> basePath<span class="op">,</span> entry<span class="op">-&gt;</span>d_name<span class="op">);</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>entry<span class="op">-&gt;</span>d_type <span class="op">==</span> DT_DIR<span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>            <span class="co">// It's a directory, recursively list its contents</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>            listFiles<span class="op">(</span>path<span class="op">,</span> entry<span class="op">-&gt;</span>d_name<span class="op">);</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>            <span class="co">// It's a file, print its relative path</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">&quot;%s/%s</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> relativePath<span class="op">,</span> entry<span class="op">-&gt;</span>d_name<span class="op">);</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    closedir<span class="op">(</span>dir<span class="op">);</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">char</span><span class="op">**</span>argv<span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> <span class="dt">char</span> <span class="op">*</span>directoryPath <span class="op">=</span> argv<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Call the function to list files</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>    listFiles<span class="op">(</span>directoryPath<span class="op">,</span><span class="st">&quot;&quot;</span><span class="op">);</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">// for(int i = 0; i &lt; n; i++){</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">//     printf(&quot;%s\n&quot;,stack[i]);</span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">// }</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</section>
</section>

        </div>
        <div id="footer">
            <div class="flex-container" style="display:flex; justify-content: space-between;">
                <div>
                    Site proudly generated by
                    <a href="http://jaspervdj.be/hakyll">Hakyll</a>
                </div>
                <div class="pagehitscounter"> 
                    <!-- <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fuserjy.github.io&count_bg=%231FDBD9&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=true"/> -->
                </div>
                <div xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://lambdaJasonYang.github.io/">Jason's Notes</a> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://lambdaJasonYang.github.io/">Jason Yang</a> is licensed under <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-ND 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nd.svg?ref=chooser-v1"></a></div>
  
            </div>
        </div>
        
    </body>
    <footer>
        <!-- CODE TAB START -->
        <script>
                    //Structure:
                    // Codeblock < Group/Grouplabel/subgrp < datagroupSet < allblocks

            const AllBlocksPre = document.querySelectorAll("[data-group]");
            const AllBlocks = [...AllBlocksPre]; //gets all codeblocks w/ and w/o group label
            const getUniqueSet = (TargetSet,dataAttr) => {
                //gets the set of attributes of an array of codeblocks aka TargetSet
                const temp = TargetSet.map((e) => (e.getAttribute(dataAttr))); 
                const temp2 = temp.filter((a)=>a); //remove nulls
                return [...new Set(temp2)];
            } 
            const datagroupSet = getUniqueSet(AllBlocks,"data-group") //remove nulls

            const getCodeBlocks = (datagroup) => {
                //return list of glabels CodeBlocks associated to a single group 
                return AllBlocks.filter((dataglabelBlock)=>(dataglabelBlock.getAttribute("data-group") === datagroup));
            }

            const showBlocks = (dataglabeltxt,datagroupCodeBlocks) => {
                const selectedglabelGroup = datagroupCodeBlocks.filter((SingleBlock)=>(SingleBlock.getAttribute("data-glabel") === dataglabeltxt))
                const NONselectedglabelGroup = datagroupCodeBlocks.filter((SingleBlock)=>(SingleBlock.getAttribute("data-glabel") !== dataglabeltxt))
                selectedglabelGroup.map((SingleBlock) => (SingleBlock.style.display="block"));
                (NONselectedglabelGroup || []).map((SingleBlock) => (SingleBlock.style.display="none"));
            }
            const mkBtn = (dataglabeltxt,datagroupCodeBlocks,showfunc) => {
                const newbutton = document.createElement("input");
                newbutton.type = "radio";
                // newbutton.textContent = dataglabeltxt;
                newbutton.addEventListener('click', ()=>{
                    // console.log(datagroupCodeBlocks)
                    showfunc(dataglabeltxt,datagroupCodeBlocks);
                });
                return newbutton;
            }
            const showAll = (datagroup) => {
                //make all codeblocks visible
            datagroup.map((e)=>(e.style.display="block"));
            }

            const buildCodeTab = (datagroupCodeBlocks,datagroup) => {
                const leaderCodeBlockDiv = datagroupCodeBlocks[0]; //get the leader codeblock of a group of codeblock
                const setglabelstxt = getUniqueSet(datagroupCodeBlocks,"data-glabel"); 
                setglabelstxt.map((singleglabeltxt)=>{
                    
                    const btn = mkBtn(singleglabeltxt,datagroupCodeBlocks,showBlocks);
                    btn.name = datagroup;
                    btn.id = datagroup+singleglabeltxt;
                    const radiolabelx = document.createElement("label");
                    radiolabelx.setAttribute("for",datagroup+singleglabeltxt);
                    radiolabelx.innerText = singleglabeltxt;
        
                    // leaderCodeBlockDiv.insertAdjacentElement("beforebegin",radiolabelx);
                    // radiolabelx.appendChild(btn);
                    const radioclass = document.createElement("div");
                    radioclass.className = "radioclass";
                    radioclass.appendChild(btn);
                    radioclass.appendChild(radiolabelx)
                    leaderCodeBlockDiv.insertAdjacentElement("beforebegin",radioclass);
                    // leaderCodeBlockDiv.prepend(btn);
                    
                    
                })
             
                // leaderCodeBlockDiv.append(btnlist);
                
                const btnShowAll = document.createElement("input");
                btnShowAll.type = "radio";
                btnShowAll.addEventListener('click',(e)=>(showAll(datagroupCodeBlocks)));

                btnShowAll.name = datagroup;
                btnShowAll.id = datagroup+"All";
                const radiolabel = document.createElement("label");
                radiolabel.setAttribute("for",datagroup+"All");
                radiolabel.innerText = "All";

                const radioclass = document.createElement("div");
                radioclass.className = "radioclass";
                radioclass.appendChild(btnShowAll);
                radioclass.appendChild(radiolabel)
                leaderCodeBlockDiv.insertAdjacentElement('beforebegin',radioclass);
                //make showAllbutton END
            }

            //below code is performing actual behavior, the above code are just functions
            datagroupSet.map((datagroup) => {
                
                const groupOfCodeblocks = getCodeBlocks(datagroup);
                buildCodeTab(groupOfCodeblocks,datagroup);
                const firsttab = groupOfCodeblocks[0];
                showBlocks(firsttab.getAttribute("data-glabel"),groupOfCodeblocks);
       
            })
        </script>
        <!-- CODE TAB END ---->

        <!-- MATH JAX START -------------------------------------- -->
        <script id="MathJax-script" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-chtml.min.js">
        </script>
        <!-- MATH JAX END ----------------------------------------- -->
        <!-- MERMAID START -------------------------------------- -->
        <script type="module"> 
            import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/+esm'
        </script>
        <!-- <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js" async></script> -->
        <!-- MERMAID END -------------------------------------- -->
        <!-- RAILROAD START -------------------------------------- -->
        <script type="module">
            import rr,* as rrClass from "/lib/railroad/railroad.js";
            Object.assign(window,rr)
            window.rrOptions = rrClass.Options;
            document.addEventListener('DOMContentLoaded',()=>{ReplaceDivWithSvg()},false)
            const ReplaceDivWithSvg = () =>  {
                for (const railroadelem of document.getElementsByClassName("rroad") ){
                railroadelem.innerHTML = eval(railroadelem.innerText.trim()+".toString()")
                }
            }
        </script>
        

        <link rel="stylesheet" href="../lib/railroad/railroad-diagrams.css">
        <!-- RAILROAD END ----------------------------------------- -->
    </footer>
</html>
